package controlador;

import java.util.ArrayList;
import java.util.List;
import java.util.Random;

import modelo.ItemListaCompra;
import modelo.ItemResultado;
import modelo.ListaCompra;
import modelo.Local;
import modelo.Producto;
import modelo.ProductoPrecio;

public class Controlador {
	
	private static Controlador instancia;

	private Controlador() {
	}

	public static Controlador getInstancia() {
		if (instancia == null)
			instancia = new Controlador();
		return instancia;
	}
	
	public ItemResultado procesarListaCompra(ListaCompra compra) {
		//Obtener todos los locales
		List<Local> locales = obtenerLocales();
		ItemResultado resultado = new ItemResultado(1, null, Float.MAX_VALUE);
		for(Local l: locales)
		{
			float presupuesto = 0;
			for(ItemListaCompra i: compra.getLista())
			{
				presupuesto += l.getPrecioDeProducto(i.getProducto().getId());
			}
			if(presupuesto < resultado.getPresupuesto())
				resultado = new ItemResultado(1,l,presupuesto);
		}
		return resultado;
	}
	
	private List<Local> obtenerLocales() {
		List<ProductoPrecio> productos1 = new ArrayList<ProductoPrecio>();
		List<ProductoPrecio> productos2 = new ArrayList<ProductoPrecio>();
		List<ProductoPrecio> productos3 = new ArrayList<ProductoPrecio>();
		List<ProductoPrecio> productos4 = new ArrayList<ProductoPrecio>();
		List<ProductoPrecio> productos5 = new ArrayList<ProductoPrecio>();
		
		List<Local> locales = new ArrayList<Local>();
		
		Random x = new Random();
		
		for(int i = 1; i <6; i++)
		{
			productos1.add(new ProductoPrecio(i, x.nextInt(50)+10));	
		}
		Local l = new Local(1, "Coto", productos1, 3.5f);
		locales.add(l);
		
		for(int i = 1; i <6; i++)
		{
			productos2.add(new ProductoPrecio(i, x.nextInt(50)+10));	
		}
		l = new Local(2, "Disco", productos2, 2.5f);
		locales.add(l);
		
		for(int i = 1; i <6; i++)
		{
			productos3.add(new ProductoPrecio(i, x.nextInt(50)+10));	
		}
		l = new Local(3, "Carrefour", productos3, 1.0f);
		locales.add(l);
		
		for(int i = 1; i <6; i++)
		{
			productos4.add(new ProductoPrecio(i, x.nextInt(50)+10));	
		}
		l = new Local(4, "Walt-Mart", productos4, 8.5f);
		locales.add(l);
		
		for(int i = 1; i <6; i++)
		{
			productos5.add(new ProductoPrecio(i, x.nextInt(50)+10));	
		}
		l = new Local(5, "Norte", productos5, 1.0f);
		locales.add(l);
		
		return locales;
	}
}

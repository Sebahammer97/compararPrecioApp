package controlador;

import java.util.ArrayList;
import java.util.List;
import java.util.Random;

import modelo.ItemListaCompra;
import modelo.ItemResultado;
import modelo.ListaCompra;
import modelo.Local;
import modelo.Producto;
import modelo.ProductoPrecio;

public class Controlador {
	
	private static Controlador instancia;

	private Controlador() {
	}

	public static Controlador getInstancia() {
		if (instancia == null)
			instancia = new Controlador();
		return instancia;
	}
	
	public ItemResultado procesarListaCompra(ListaCompra compra) {
		//Obtener todos los locales
		List<Local> locales = obtenerLocales();
		ItemResultado resultado = new ItemResultado(1, null, Float.MAX_VALUE);
		for(Local l: locales)
		{
			float presupuesto = 0;
			for(ItemListaCompra i: compra.getLista())
			{
				presupuesto += l.getPrecioDeProducto(i.getProducto().getId());
			}
			if(presupuesto < resultado.getPresupuesto())
				resultado = new ItemResultado(1,l,presupuesto);
		}
		return resultado;
	}
	
	private List<Local> obtenerLocales() {
		List<ProductoPrecio> productos = new ArrayList<ProductoPrecio>();
		List<Local> locales = new ArrayList<Local>();
		
		Random x = new Random();
		
		for(int i = 1; i <6; i++)
		{
			productos.add(new ProductoPrecio(i, x.nextInt(50)+10));	
		}
		Local l = new Local(1, "Coto", productos, 3.5f);
		locales.add(l);
		productos.clear();
		
		for(int i = 1; i <6; i++)
		{
			productos.add(new ProductoPrecio(i, x.nextInt(50)+10));	
		}
		l = new Local(2, "Disco", productos, 2.5f);
		locales.add(l);
		productos.clear();
		
		for(int i = 1; i <6; i++)
		{
			productos.add(new ProductoPrecio(i, x.nextInt(50)+10));	
		}
		l = new Local(3, "Carrefour", productos, 1.0f);
		locales.add(l);
		productos.clear();
		
		for(int i = 1; i <6; i++)
		{
			productos.add(new ProductoPrecio(i, x.nextInt(50)+10));	
		}
		l = new Local(4, "Walt-Mart", productos, 8.5f);
		locales.add(l);
		productos.clear();
		
		for(int i = 1; i <6; i++)
		{
			productos.add(new ProductoPrecio(i, x.nextInt(50)+10));	
		}
		l = new Local(5, "Norte", productos, 1.0f);
		locales.add(l);
		productos.clear();
		
		return locales;
	}
}
